## 4.1 基础

### 4.1.1基本概念

参加运算时，小整数类型（如`bool`、`char`、`short`等）通常会被**提升（promoted）**成较大的整数类型，主要是`int`。

#### 左值与右值

 C++的表达式要么是左值（`lvalue`），要么是右值（`rvalue`）。

当一个对象被用作右值的时候，用的是对象的值（内容）；当一个对象被用作左值的时候，用的是对象的身份（在内存中的位置）。

一个重要的原则是当要用到一个右值的时候，可以用一个左值来取代它（13.6节介绍了一种例外），反之则不可。当一个左值被当作右值使用时，实际使用的是它的内容（值）。

### 4.1.3 求值顺序

C++没有明确规定大多数二元运算符的求值顺序，给编译器优化留下了余地。这实际上是在代码生成效率与程序潜在缺陷之间进行了权衡。

运算对象的求值顺序与优先级和结合律无关。

一些例子：

```c++
int i = f1() * f2();

int a = 0;
cout << a << " " << ++a << endl;
```

`f1()`和`f2()`一定会在乘法之前被调用，但是哪个先被调用是不确定的。如果`f1()`和`f2()`影响的对象没有交叉，那么无伤大雅；如果二者存在同时影响一个对象的情况，那么将产生未定义的行为。在不同的编译器中可能产生不同的结果。

同样，`<<`运算符并没有规定求值顺序，`++a`可能先于`a`执行，也可能是在`a`之后才执行。这是未定义的行为。

有4种运算符明确规定了运算对象的求值顺序：

- `&&`运算符，规定先求左侧的值，左侧为假结果立即为假，不再对右侧求值。
- `||`运算符，规定先求左侧的值，左侧为真结果立即为真，不再对右侧求值。
- `?:`（三目运算符）
- `,`（逗号运算符）

## 4.2 算术运算符

一元符号运算符对运算对象取负后，返回其（提升后的）副本。注意：

```c++
bool b = true;
bool b2 = -b;
```

这里`b2`的值是`true`。因为`bool`参与运算时被提升成`int`，取负结果为`-1`，`-1`显然是`true`的。

C++ 11规定除法运算中负的商一律向0取整，即直接切除小数部分。

C++ 11规定取模运算中模的符号和**被取模数**相等，商向0取整。一些例子：



```c++
21 / 6 == 3;
21 / 7 == 3;
-21 / -8 == 2;
21 / -5 == -4;
    
21 % 6 == 3;
21 % 7 == 0;
-21 % -8 == -5;
21 % -5 == 1;
```

## 4.4 赋值运算符

赋值运算符的左侧运算对象必须是一个**可修改的左值**。

